<!-- Page Content -->
<div id="page-content-wrapper">
  <div class="container-fluid">
          <section>
              <div>
                  <div class="container">
                        <div class="card shadow mb-4">
                          <div class="card-header py-3">
                              <h6 class="m-0 font-weight-bold text-primary">Assigned Research For Review</h6>
                              <!-- <div class="input-group">
                                <input type="text" id="tableSearch" class="form-control bg-light border-1 small" placeholder="Search for..."
                                    aria-label="Search" aria-describedby="basic-addon2">
                                <div class="input-group-append">
                                    <button class="btn btn-primary disabled" type="button">
                                        <i class="fas fa-search fa-sm"></i>
                                    </button>
                                </div>
                            </div>
                            <select name="filter" id="filter">
                              <option value="">None</option>
                              <option value="External">External</option>
                              <option value="Internal">Internal</option>
                              <option value="pending">Pending</option>
                              <option value="approved">Approved</option>
                            </select> -->
  
                          </div>
                          <div class="card-body">
                              <div class="table-responsive">
                                  <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                                      <thead>
                          <tr>
                            <th>Title</th>
                            <th>Funding</th>
                            <th>Status</th>
                            <th>Approve</th>
                            <th>Download</th>
                          </tr>
                        </thead>
                        <tbody id="myTable"></tbody>
                      </table>
                    </div>
                    </div>
                    </div>
                  </div>  
          </section>
  </div>
</div>
</div> <!-- /#page-content-wrapper -->

<div class="modal fade" id="assignReviewer" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
aria-hidden="true">
<div class="modal-dialog modal-lg" role="document">
  <div class="modal-content">
      <div class="modal-header">
          <h5 class="modal-title text-primary" id="exampleModalLabel">Select Co Author</h5>
          <button class="close" id="closeModal" type="button">
              <span aria-hidden="true">Ã—</span>
          </button>
      </div>
      <div class="modal-body">
          <div class="card-body" id="">
            <form
            class="navbar-search" id="reviewerForm">
            <div class="input-group">
                <input type="text" id="reviewersearch" class="form-control bg-light border-0 small" placeholder="Search for Main Author"
                    aria-label="Search" aria-describedby="basic-addon2">
                <div class="input-group-append">
                    <button class="btn btn-primary" type="button">
                        <i class="fas fa-search fa-sm"></i>
                    </button>
                </div>
            </div>
            <select class="form-group mx-sm-3 mb-2" name="mainAuthorFilter" id="mainAuthorFilter">
              <option disabled selected="selectHelper" value="">Filter By College</option>
              <option value="College of Computer Studies">College of Computer Studies</option>
              <option value="">Test3</option>
            </select>
            <div class="table-responsive">
              <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
        <thead>
      <tr>
        <th>ID</th>
        <th>Title</th>
        <th>Funding</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody id="myTable"></tbody>
  </table>
  <button class="btn btn-primary" id="assgnRev" type="submit">Assign As Reviewer</button>
</div>
        </form>
                </div>
      </div>
      <div class="modal-footer">
      </div>
  </div>
</div>
</div>


<script>
  $(function() {
      function load_proposals(){
$.ajax({
  url: '../forms/review.php',
  type: 'get',
  dataType: 'JSON',
  success: function(response){
      if(response.length == 0){
         $('.card-body').html('<div class="d-flex justify-content-center"><h2> No Ongoing Research For Review</h2></div>')
      }
      else{
    response.forEach(({id, title, funding, status, filename }) => {
    var author=`<tr>
      <td align='center'>${title}</td>
      <td align='center'>${funding}</td>
      <td align='center'>${status}</td>
      <td align='center'><button id='approved' class='btn btn-success' value="${id}"><i class="fas fa-check"></i></button></td>
      <td align='center'><a href="../forms/download.php?fileName=${filename}">Download</a></td>
    </tr>`;
          $("#myTable").append(author);
      }
  
    )}
  }
  });
}
  load_proposals();
  })
  
  $('#myTable').on('click', '#approved', function(){
      var thisbtn = $(this).attr('value');
      console.log(thisbtn);
      bootbox.confirm("Approve This Research?", function(result) {
        if(result){
      $.ajax({
  url: '../forms/approved.php?id='+thisbtn,
  type: 'post',
  dataType: 'JSON',
  success: function(response){
    bootbox.alert('Research Approved')
  }
  });
}
  })
  })

</script>