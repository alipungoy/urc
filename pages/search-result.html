<h3 class="display-6 mb-3">Search Result</h3>
<section class="container mt-5">
    <div class="mb-5">
        <div id="result" class="row container">
            <ol class="d-block">

            </ol>
        </div>
    </div>
</section>

<script>
    // Function to highlight the search term in the text
    function highlightSearchTerm(searchTerm, text) {
    const escapedTerm = String(searchTerm).replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    const regex = new RegExp(escapedTerm, 'gi');
    var highlightedText = text.replace(regex, '<span class="highlighted">$&</span>');
    return highlightedText;
}

    $(function () {
        const val = window.location.search.slice(3).split('+');
        const data = val.join(" ");
        console.log(data);

        $.ajax({
            url: 'api/post/search.php',
            dataType: 'json',
            type: 'POST',
            data: { "term": data },
            success: function (data) {
                if (data != 'empty') {
                    data.forEach(({
                        id,
                        abstract,
                        authors,
                        title
                    }) => {
                        // Highlight the search term in title, abstract, and authors
                        title = highlightSearchTerm(data, title);
                        abstract = highlightSearchTerm(data, abstract);
                        authors = highlightSearchTerm(data, authors);

                        $("#result ol").append(`<li class="mb-5" style="list-style-type:none;">
                            <div>
                                <a href="journal-details.php?type=patubas&id=${id}">${title}</a>
                                <div>
                                    <p>${abstract}
                                        </p>
                                </div>
                                <div>
                                    <small>${authors}</small>
                                    </div>
                            </li>`);
                    });
                } else {
                    $('#result ol').append(`<li><h1>No results found.</h1></li>`);
                }
            }

        })
    });
</script>