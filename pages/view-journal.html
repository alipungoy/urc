<section id="scientia" class="container mt-5">
    <h3 class="display-6 mb-0 title">...</h3>
    <div id="info" class="mb-3 d-flex align-items-center author" style="font-size: medium; font-style: italic;"></div>
    <!-- <div class="mb-5">
        <div id="img"></div>
        <p class="text-center mt-2">Click image to download</p>
    </div> -->
    <section class="mt-5">
        <div class="mb-3">
            <h3>Abstract</h3></br>
            <h3 class="border-bottom border-secondary mb-5"></h3>
            <p class="abstract">Patubas is published once a year under the auspices of Central Philippine University,
                Jaro, Iloilo City,
                Philippines.</p>
        </div>
        </div>
    </section>
</section>

<section id="patubas" class="container mt-5">
    <h3 class="display-8 mb-0 volume text-info">...</h3>
    <div class="row">
        <div class="col-md-4">
            <div class="mb-5">
                <div class="img d-flex justify-content-start">
                </div>
                <small class="text-center mt-2 fst-italic">* Click image to download</small>
            </div>
        </div>
        <div class="col-md-4" id="patubasDetails">
        </div>
    </div>
</section>


<script>
    $(function () {
        var type = window.location.search.slice(1).split("&")[0].split("=")[1];
        var id = window.location.search.slice(1).split("&")[1].split("=")[1];
        console.log(id)
        $(function () {
            $.ajax({
                url: 'forms/journaldisplay.php',
                type: 'get',
                data: { "type": type, "id": id },
                dataType: 'JSON',
                success: function (data) {
                    if (type === 'scientia') {
                        $(".title").html(data.title);
                        $(".abstract").html(data.abstract)
                        $('.author').html('By:' + data.author)
                    } else if (type === 'patubas') {
                        return data.forEach(({ id, abstract, authors, cp, date, file, title, volume }) => {
                            $('.volume').html(`Volume ${volume} No. 1 ${date}`)
                            $('.img').html(`<img src="journals/coverphoto/${cp}" id="${file}" class="download" style="height: 30rem; width: 20rem; object-fit: contain;">`);
                            $('#patubasDetails').append(`<a href="#" class="fw-bold title" id="${id}">${title}</a>
                            <div id="details${id}" style="display: none">
                            <p class="fst-italic authors">By: ${authors}</p>
                            <h6 class="fw-bold">Abstract</h6 class="fw-bold">
                            <p class="abstract">${abstract}</p></div><hr>`);

                        })
                    }
                }
            });
        });

        $(document).ready(function () {
            const type = window.location.search.slice(1).split("&")[0].split("=")[1];
            const id = window.location.search.slice(1).split("&")[1].split("=")[1];

            if (type === 'patubas') {
                $("#scientia").css("display", "none")
            }
            else if (type === 'scientia') {
                $("#patubas").css("display", "none")
            }
        });

        //download
        $(document).on('click', '.img', function (e) {
            e.preventDefault();
            const id = $(".download").attr('id');

            window.location = "forms/download.php?file=" + id;
        });


        $(document).on('click', 'a.title', function (e) {
            e.preventDefault();
            const id = $(this).attr('id');
            $('#details' + id).slideToggle('slow');
        });


    })
</script>